"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/layout",{

/***/ "(app-pages-browser)/./src/contexts/AuthContext.tsx":
/*!**************************************!*\
  !*** ./src/contexts/AuthContext.tsx ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthProvider: () => (/* binding */ AuthProvider),\n/* harmony export */   useAuth: () => (/* binding */ useAuth)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/../../node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/../../node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_navigation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/navigation */ \"(app-pages-browser)/../../node_modules/next/dist/api/navigation.js\");\n/* __next_internal_client_entry_do_not_use__ AuthProvider,useAuth auto */ \nvar _s = $RefreshSig$(), _s1 = $RefreshSig$();\n\n\nconst AuthContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(undefined);\nconst AuthProvider = (param)=>{\n    let { children } = param;\n    _s();\n    const [user, setUser] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [isAuthenticated, setIsAuthenticated] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [tokenRefreshInterval, setTokenRefreshInterval] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [sessionCheckInterval, setSessionCheckInterval] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const router = (0,next_navigation__WEBPACK_IMPORTED_MODULE_2__.useRouter)();\n    const checkSession = ()=>{\n        try {\n            const userData = localStorage.getItem('userData');\n            if (!userData) return false;\n            const userObj = JSON.parse(userData);\n            if (!userObj.exp) return true;\n            const currentTime = Math.floor(Date.now() / 1000);\n            return currentTime < userObj.exp;\n        } catch (error) {\n            console.error('Lỗi kiểm tra phiên:', error);\n            return false;\n        }\n    };\n    const checkAndLogoutIfExpired = ()=>{\n        if (!checkSession()) {\n            console.log('Phiên làm việc đã hết hạn. Đang đăng xuất...');\n            logout();\n            return false;\n        }\n        return true;\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            const checkAuth = {\n                \"AuthProvider.useEffect.checkAuth\": async ()=>{\n                    try {\n                        const token = localStorage.getItem('token');\n                        if (!token) {\n                            setIsLoading(false);\n                            router.push('/signin');\n                            return;\n                        }\n                        if (!checkSession()) {\n                            console.log('Phiên đăng nhập đã hết hạn khi tải trang');\n                            localStorage.removeItem('token');\n                            localStorage.removeItem('userData');\n                            localStorage.removeItem('refreshToken');\n                            document.cookie = 'token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n                            document.cookie = 'userData=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n                            setIsLoading(false);\n                            router.push('/signin');\n                            return;\n                        }\n                        const userDataStr = localStorage.getItem('userData');\n                        if (userDataStr) {\n                            const userData = JSON.parse(userDataStr);\n                            if (userData.role !== 'admin') {\n                                localStorage.removeItem('token');\n                                localStorage.removeItem('userData');\n                                setIsLoading(false);\n                                router.push('/signin');\n                                return;\n                            }\n                            setUser(userData);\n                            setIsAuthenticated(true);\n                        } else {\n                            localStorage.removeItem('token');\n                            router.push('/signin');\n                        }\n                    } catch (error) {\n                        console.error('Auth check failed:', error);\n                        localStorage.removeItem('token');\n                        localStorage.removeItem('userData');\n                        router.push('/signin');\n                    } finally{\n                        setIsLoading(false);\n                    }\n                }\n            }[\"AuthProvider.useEffect.checkAuth\"];\n            checkAuth();\n        }\n    }[\"AuthProvider.useEffect\"], [\n        router\n    ]);\n    const login = async (email, password)=>{\n        try {\n            const API_URL = \"http://localhost:5000/api\" || 0;\n            console.log('Login API URL:', \"\".concat(API_URL, \"/users/admin/login\"));\n            const response = await fetch(\"\".concat(API_URL, \"/users/admin/login\"), {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    email,\n                    password\n                }),\n                cache: 'no-store'\n            });\n            if (!response.ok) {\n                console.error('Login failed with status:', response.status);\n                const text = await response.text();\n                console.error('Response text:', text);\n                let errorMessage = 'Đăng nhập thất bại';\n                try {\n                    const errorData = JSON.parse(text);\n                    errorMessage = errorData.message || errorMessage;\n                } catch (e) {\n                // Nếu không phải JSON, sử dụng message mặc định\n                }\n                throw new Error(errorMessage);\n            }\n            const data = await response.json();\n            if (!data || !data.token) {\n                throw new Error('Phản hồi không hợp lệ từ máy chủ');\n            }\n            const tokenExpiry = Math.floor(Date.now() / 1000) + 8 * 60 * 60;\n            const userData = {\n                ...data,\n                exp: tokenExpiry\n            };\n            localStorage.setItem('token', data.token);\n            localStorage.setItem('refreshToken', data.refreshToken);\n            localStorage.setItem('userData', JSON.stringify(userData));\n            localStorage.setItem('admin_token', data.token);\n            localStorage.setItem('admin_refresh_token', data.refreshToken);\n            localStorage.setItem('admin_user', JSON.stringify({\n                _id: data._id,\n                full_name: data.full_name,\n                email: data.email,\n                role: data.role\n            }));\n            document.cookie = \"token=\".concat(data.token, \"; path=/; max-age=\").concat(60 * 60 * 8);\n            document.cookie = \"userData=\".concat(encodeURIComponent(JSON.stringify(userData)), \"; path=/; max-age=\").concat(60 * 60 * 8);\n            setUser(userData);\n            setIsAuthenticated(true);\n            return userData;\n        } catch (error) {\n            console.error('Login error:', error);\n            throw error;\n        }\n    };\n    const logout = ()=>{\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        localStorage.removeItem('userData');\n        localStorage.removeItem('admin_token');\n        localStorage.removeItem('admin_refresh_token');\n        localStorage.removeItem('admin_user');\n        document.cookie = 'token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n        document.cookie = 'userData=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n        if (tokenRefreshInterval) {\n            clearInterval(tokenRefreshInterval);\n        }\n        if (sessionCheckInterval) {\n            clearInterval(sessionCheckInterval);\n        }\n        setUser(null);\n        setIsAuthenticated(false);\n        router.push('/signin');\n    };\n    const refreshToken = async ()=>{\n        try {\n            const refreshToken = localStorage.getItem('refreshToken');\n            if (!refreshToken) {\n                throw new Error('Không tìm thấy refresh token');\n            }\n            const API_URL = \"http://localhost:5000/api\" || 0;\n            const response = await fetch(\"\".concat(API_URL, \"/users/admin/refresh-token\"), {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    refreshToken\n                })\n            });\n            const data = await response.json();\n            if (!response.ok) {\n                throw new Error(data.message || 'Không thể làm mới token');\n            }\n            const userDataStr = localStorage.getItem('userData');\n            if (userDataStr) {\n                const userData = JSON.parse(userDataStr);\n                const tokenExpiry = Math.floor(Date.now() / 1000) + 8 * 60 * 60;\n                const updatedUserData = {\n                    ...userData,\n                    exp: tokenExpiry\n                };\n                localStorage.setItem('userData', JSON.stringify(updatedUserData));\n                document.cookie = \"userData=\".concat(encodeURIComponent(JSON.stringify(updatedUserData)), \"; path=/; max-age=\").concat(60 * 60 * 8);\n                setUser(updatedUserData);\n            }\n            localStorage.setItem('token', data.token);\n            document.cookie = \"token=\".concat(data.token, \"; path=/; max-age=\").concat(60 * 60 * 8);\n            return data.token;\n        } catch (error) {\n            console.error('Lỗi làm mới token:', error);\n            logout();\n            return null;\n        }\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            if (isAuthenticated) {\n                const interval = setInterval({\n                    \"AuthProvider.useEffect.interval\": ()=>{\n                        refreshToken();\n                    }\n                }[\"AuthProvider.useEffect.interval\"], 7 * 60 * 60 * 1000);\n                const sessionInterval = setInterval({\n                    \"AuthProvider.useEffect.sessionInterval\": ()=>{\n                        checkAndLogoutIfExpired();\n                    }\n                }[\"AuthProvider.useEffect.sessionInterval\"], 60 * 1000);\n                setTokenRefreshInterval(interval);\n                setSessionCheckInterval(sessionInterval);\n                return ({\n                    \"AuthProvider.useEffect\": ()=>{\n                        clearInterval(interval);\n                        clearInterval(sessionInterval);\n                        setTokenRefreshInterval(null);\n                        setSessionCheckInterval(null);\n                    }\n                })[\"AuthProvider.useEffect\"];\n            }\n        }\n    }[\"AuthProvider.useEffect\"], [\n        isAuthenticated,\n        router\n    ]);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AuthContext.Provider, {\n        value: {\n            user,\n            isAuthenticated,\n            isLoading,\n            login,\n            logout,\n            refreshToken,\n            checkSession\n        },\n        children: children\n    }, void 0, false, {\n        fileName: \"D:\\\\used-car-marketplace\\\\packages\\\\admin\\\\src\\\\contexts\\\\AuthContext.tsx\",\n        lineNumber: 270,\n        columnNumber: 5\n    }, undefined);\n};\n_s(AuthProvider, \"4VyQJstUGdGsrPBfSuTGV++7kLk=\", false, function() {\n    return [\n        next_navigation__WEBPACK_IMPORTED_MODULE_2__.useRouter\n    ];\n});\n_c = AuthProvider;\nconst useAuth = ()=>{\n    _s1();\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(AuthContext);\n    if (context === undefined) {\n        throw new Error('useAuth phải được sử dụng trong phạm vi AuthProvider');\n    }\n    return context;\n};\n_s1(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb250ZXh0cy9BdXRoQ29udGV4dC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFFeUY7QUFDN0M7QUFxQjVDLE1BQU1NLDRCQUFjTCxvREFBYUEsQ0FBOEJNO0FBRXhELE1BQU1DLGVBQWU7UUFBQyxFQUFFQyxRQUFRLEVBQTJCOztJQUNoRSxNQUFNLENBQUNDLE1BQU1DLFFBQVEsR0FBR1QsK0NBQVFBLENBQWM7SUFDOUMsTUFBTSxDQUFDVSxpQkFBaUJDLG1CQUFtQixHQUFHWCwrQ0FBUUEsQ0FBQztJQUN2RCxNQUFNLENBQUNZLFdBQVdDLGFBQWEsR0FBR2IsK0NBQVFBLENBQUM7SUFDM0MsTUFBTSxDQUFDYyxzQkFBc0JDLHdCQUF3QixHQUFHZiwrQ0FBUUEsQ0FBd0I7SUFDeEYsTUFBTSxDQUFDZ0Isc0JBQXNCQyx3QkFBd0IsR0FBR2pCLCtDQUFRQSxDQUF3QjtJQUN4RixNQUFNa0IsU0FBU2YsMERBQVNBO0lBRXhCLE1BQU1nQixlQUFlO1FBQ25CLElBQUk7WUFDRixNQUFNQyxXQUFXQyxhQUFhQyxPQUFPLENBQUM7WUFDdEMsSUFBSSxDQUFDRixVQUFVLE9BQU87WUFFdEIsTUFBTUcsVUFBVUMsS0FBS0MsS0FBSyxDQUFDTDtZQUMzQixJQUFJLENBQUNHLFFBQVFHLEdBQUcsRUFBRSxPQUFPO1lBRXpCLE1BQU1DLGNBQWNDLEtBQUtDLEtBQUssQ0FBQ0MsS0FBS0MsR0FBRyxLQUFLO1lBQzVDLE9BQU9KLGNBQWNKLFFBQVFHLEdBQUc7UUFDbEMsRUFBRSxPQUFPTSxPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyx1QkFBdUJBO1lBQ3JDLE9BQU87UUFDVDtJQUNGO0lBRUEsTUFBTUUsMEJBQTBCO1FBQzlCLElBQUksQ0FBQ2YsZ0JBQWdCO1lBQ25CYyxRQUFRRSxHQUFHLENBQUM7WUFDWkM7WUFDQSxPQUFPO1FBQ1Q7UUFDQSxPQUFPO0lBQ1Q7SUFFQW5DLGdEQUFTQTtrQ0FBQztZQUNSLE1BQU1v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RUFBQyxzQkFBNEIsT0FBUixLQUFHLEtBQUc7WUFFaEUsT0FBTzZCLEtBQUs3QixLQUFLO1FBQ25CLEVBQUUsT0FBT04sT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsc0JBQXNCQTtZQUNwQ0k7WUFDQSxPQUFPO1FBQ1Q7SUFDRjtJQUVBbkMsZ0RBQVNBO2tDQUFDO1lBQ1IsSUFBSVMsaUJBQWlCO2dCQUNuQixNQUFNbUUsV0FBV0M7dURBQVk7d0JBQzNCUDtvQkFDRjtzREFBRyxJQUFJLEtBQUssS0FBSztnQkFFakIsTUFBTVEsa0JBQWtCRDs4REFBWTt3QkFDbEM1QztvQkFDRjs2REFBRyxLQUFLO2dCQUVSbkIsd0JBQXdCOEQ7Z0JBQ3hCNUQsd0JBQXdCOEQ7Z0JBRXhCOzhDQUFPO3dCQUNMSixjQUFjRTt3QkFDZEYsY0FBY0k7d0JBQ2RoRSx3QkFBd0I7d0JBQ3hCRSx3QkFBd0I7b0JBQzFCOztZQUNGO1FBQ0Y7aUNBQUc7UUFBQ1A7UUFBaUJRO0tBQU87SUFFNUIscUJBQ0UsOERBQUNkLFlBQVk0RSxRQUFRO1FBQ25CQyxPQUFPO1lBQ0x6RTtZQUNBRTtZQUNBRTtZQUNBaUM7WUFDQVQ7WUFDQW1DO1lBQ0FwRDtRQUNGO2tCQUVDWjs7Ozs7O0FBR1AsRUFBRTtHQWpRV0Q7O1FBTUlILHNEQUFTQTs7O0tBTmJHO0FBbVFOLE1BQU00RSxVQUFVOztJQUNyQixNQUFNQyxVQUFVakYsaURBQVVBLENBQUNFO0lBRTNCLElBQUkrRSxZQUFZOUUsV0FBVztRQUN6QixNQUFNLElBQUk2RCxNQUFNO0lBQ2xCO0lBRUEsT0FBT2lCO0FBQ1QsRUFBRTtJQVJXRCIsInNvdXJjZXMiOlsiRDpcXHVzZWQtY2FyLW1hcmtldHBsYWNlXFxwYWNrYWdlc1xcYWRtaW5cXHNyY1xcY29udGV4dHNcXEF1dGhDb250ZXh0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCc7XG5cbmltcG9ydCBSZWFjdCwgeyBjcmVhdGVDb250ZXh0LCB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VDb250ZXh0LCBSZWFjdE5vZGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L25hdmlnYXRpb24nO1xuXG5pbnRlcmZhY2UgVXNlciB7XG4gIF9pZDogc3RyaW5nO1xuICBmdWxsX25hbWU6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgcm9sZTogJ2FkbWluJztcbiAgYXZhdGFyX3VybD86IHN0cmluZztcbiAgZXhwPzogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgQXV0aENvbnRleHRUeXBlIHtcbiAgdXNlcjogVXNlciB8IG51bGw7XG4gIGlzQXV0aGVudGljYXRlZDogYm9vbGVhbjtcbiAgaXNMb2FkaW5nOiBib29sZWFuO1xuICBsb2dpbjogKGVtYWlsOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpID0+IFByb21pc2U8YW55PjtcbiAgbG9nb3V0OiAoKSA9PiB2b2lkO1xuICByZWZyZXNoVG9rZW46ICgpID0+IFByb21pc2U8c3RyaW5nIHwgbnVsbD47XG4gIGNoZWNrU2Vzc2lvbjogKCkgPT4gYm9vbGVhbjtcbn1cblxuY29uc3QgQXV0aENvbnRleHQgPSBjcmVhdGVDb250ZXh0PEF1dGhDb250ZXh0VHlwZSB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcblxuZXhwb3J0IGNvbnN0IEF1dGhQcm92aWRlciA9ICh7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0Tm9kZSB9KSA9PiB7XG4gIGNvbnN0IFt1c2VyLCBzZXRVc2VyXSA9IHVzZVN0YXRlPFVzZXIgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2lzQXV0aGVudGljYXRlZCwgc2V0SXNBdXRoZW50aWNhdGVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xuICBjb25zdCBbdG9rZW5SZWZyZXNoSW50ZXJ2YWwsIHNldFRva2VuUmVmcmVzaEludGVydmFsXSA9IHVzZVN0YXRlPE5vZGVKUy5UaW1lb3V0IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtzZXNzaW9uQ2hlY2tJbnRlcnZhbCwgc2V0U2Vzc2lvbkNoZWNrSW50ZXJ2YWxdID0gdXNlU3RhdGU8Tm9kZUpTLlRpbWVvdXQgfCBudWxsPihudWxsKTtcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XG5cbiAgY29uc3QgY2hlY2tTZXNzaW9uID0gKCk6IGJvb2xlYW4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyRGF0YScpO1xuICAgICAgaWYgKCF1c2VyRGF0YSkgcmV0dXJuIGZhbHNlO1xuICAgICAgXG4gICAgICBjb25zdCB1c2VyT2JqID0gSlNPTi5wYXJzZSh1c2VyRGF0YSk7XG4gICAgICBpZiAoIXVzZXJPYmouZXhwKSByZXR1cm4gdHJ1ZTtcbiAgICAgIFxuICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcbiAgICAgIHJldHVybiBjdXJyZW50VGltZSA8IHVzZXJPYmouZXhwO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdM4buXaSBraeG7g20gdHJhIHBoacOqbjonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuICBcbiAgY29uc3QgY2hlY2tBbmRMb2dvdXRJZkV4cGlyZWQgPSAoKSA9PiB7XG4gICAgaWYgKCFjaGVja1Nlc3Npb24oKSkge1xuICAgICAgY29uc29sZS5sb2coJ1BoacOqbiBsw6BtIHZp4buHYyDEkcOjIGjhur90IGjhuqFuLiDEkGFuZyDEkcSDbmcgeHXhuqV0Li4uJyk7XG4gICAgICBsb2dvdXQoKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBjaGVja0F1dGggPSBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpO1xuICAgICAgICBpZiAoIXRva2VuKSB7XG4gICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICByb3V0ZXIucHVzaCgnL3NpZ25pbicpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY2hlY2tTZXNzaW9uKCkpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnUGhpw6puIMSRxINuZyBuaOG6rXAgxJHDoyBo4bq/dCBo4bqhbiBraGkgdOG6o2kgdHJhbmcnKTtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlckRhdGEnKTtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncmVmcmVzaFRva2VuJyk7XG4gICAgICAgICAgZG9jdW1lbnQuY29va2llID0gJ3Rva2VuPTsgcGF0aD0vOyBleHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDAgR01UJztcbiAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSAndXNlckRhdGE9OyBwYXRoPS87IGV4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVQnO1xuICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgcm91dGVyLnB1c2goJy9zaWduaW4nKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1c2VyRGF0YVN0ciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyRGF0YScpO1xuICAgICAgICBpZiAodXNlckRhdGFTdHIpIHtcbiAgICAgICAgICBjb25zdCB1c2VyRGF0YSA9IEpTT04ucGFyc2UodXNlckRhdGFTdHIpO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmICh1c2VyRGF0YS5yb2xlICE9PSAnYWRtaW4nKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyRGF0YScpO1xuICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIHJvdXRlci5wdXNoKCcvc2lnbmluJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHNldFVzZXIodXNlckRhdGEpO1xuICAgICAgICAgIHNldElzQXV0aGVudGljYXRlZCh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTtcbiAgICAgICAgICByb3V0ZXIucHVzaCgnL3NpZ25pbicpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdBdXRoIGNoZWNrIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlckRhdGEnKTtcbiAgICAgICAgcm91dGVyLnB1c2goJy9zaWduaW4nKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNoZWNrQXV0aCgpO1xuICB9LCBbcm91dGVyXSk7XG5cbiAgY29uc3QgbG9naW4gPSBhc3luYyAoZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IEFQSV9VUkwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUElfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjUwMDAvYXBpJztcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ0xvZ2luIEFQSSBVUkw6JywgYCR7QVBJX1VSTH0vdXNlcnMvYWRtaW4vbG9naW5gKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtBUElfVVJMfS91c2Vycy9hZG1pbi9sb2dpbmAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsLCBwYXNzd29yZCB9KSxcbiAgICAgICAgY2FjaGU6ICduby1zdG9yZSdcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGZhaWxlZCB3aXRoIHN0YXR1czonLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICBjb25zb2xlLmVycm9yKCdSZXNwb25zZSB0ZXh0OicsIHRleHQpO1xuICAgICAgICBcbiAgICAgICAgbGV0IGVycm9yTWVzc2FnZSA9ICfEkMSDbmcgbmjhuq1wIHRo4bqldCBi4bqhaSc7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gSlNPTi5wYXJzZSh0ZXh0KTtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBlcnJvckRhdGEubWVzc2FnZSB8fCBlcnJvck1lc3NhZ2U7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAvLyBO4bq/dSBraMO0bmcgcGjhuqNpIEpTT04sIHPhu60gZOG7pW5nIG1lc3NhZ2UgbeG6t2MgxJHhu4tuaFxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgaWYgKCFkYXRhIHx8ICFkYXRhLnRva2VuKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUGjhuqNuIGjhu5NpIGtow7RuZyBo4bujcCBs4buHIHThu6sgbcOheSBjaOG7pycpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB0b2tlbkV4cGlyeSA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgOCAqIDYwICogNjA7XG4gICAgICBjb25zdCB1c2VyRGF0YSA9IHsgLi4uZGF0YSwgZXhwOiB0b2tlbkV4cGlyeSB9O1xuICAgICAgXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndG9rZW4nLCBkYXRhLnRva2VuKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyZWZyZXNoVG9rZW4nLCBkYXRhLnJlZnJlc2hUb2tlbik7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlckRhdGEnLCBKU09OLnN0cmluZ2lmeSh1c2VyRGF0YSkpO1xuICAgICAgXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWRtaW5fdG9rZW4nLCBkYXRhLnRva2VuKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhZG1pbl9yZWZyZXNoX3Rva2VuJywgZGF0YS5yZWZyZXNoVG9rZW4pO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FkbWluX3VzZXInLCBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIF9pZDogZGF0YS5faWQsXG4gICAgICAgIGZ1bGxfbmFtZTogZGF0YS5mdWxsX25hbWUsXG4gICAgICAgIGVtYWlsOiBkYXRhLmVtYWlsLFxuICAgICAgICByb2xlOiBkYXRhLnJvbGVcbiAgICAgIH0pKTtcbiAgICAgIFxuICAgICAgZG9jdW1lbnQuY29va2llID0gYHRva2VuPSR7ZGF0YS50b2tlbn07IHBhdGg9LzsgbWF4LWFnZT0kezYwKjYwKjh9YDtcbiAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGB1c2VyRGF0YT0ke2VuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh1c2VyRGF0YSkpfTsgcGF0aD0vOyBtYXgtYWdlPSR7NjAqNjAqOH1gO1xuICAgICAgXG4gICAgICBzZXRVc2VyKHVzZXJEYXRhKTtcbiAgICAgIHNldElzQXV0aGVudGljYXRlZCh0cnVlKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHVzZXJEYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGVycm9yOicsIGVycm9yKTtcbiAgICAgIFxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGxvZ291dCA9ICgpID0+IHtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncmVmcmVzaFRva2VuJyk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJEYXRhJyk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FkbWluX3Rva2VuJyk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FkbWluX3JlZnJlc2hfdG9rZW4nKTtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYWRtaW5fdXNlcicpO1xuICAgIFxuICAgIGRvY3VtZW50LmNvb2tpZSA9ICd0b2tlbj07IHBhdGg9LzsgZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVCc7XG4gICAgZG9jdW1lbnQuY29va2llID0gJ3VzZXJEYXRhPTsgcGF0aD0vOyBleHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDAgR01UJztcbiAgICBcbiAgICBpZiAodG9rZW5SZWZyZXNoSW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodG9rZW5SZWZyZXNoSW50ZXJ2YWwpO1xuICAgIH1cbiAgICBcbiAgICBpZiAoc2Vzc2lvbkNoZWNrSW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwoc2Vzc2lvbkNoZWNrSW50ZXJ2YWwpO1xuICAgIH1cbiAgICBcbiAgICBzZXRVc2VyKG51bGwpO1xuICAgIHNldElzQXV0aGVudGljYXRlZChmYWxzZSk7XG4gICAgcm91dGVyLnB1c2goJy9zaWduaW4nKTtcbiAgfTtcblxuICBjb25zdCByZWZyZXNoVG9rZW4gPSBhc3luYyAoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWZyZXNoVG9rZW4nKTtcbiAgICAgIGlmICghcmVmcmVzaFRva2VuKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignS2jDtG5nIHTDrG0gdGjhuqV5IHJlZnJlc2ggdG9rZW4nKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgQVBJX1VSTCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQSV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9hcGknO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0FQSV9VUkx9L3VzZXJzL2FkbWluL3JlZnJlc2gtdG9rZW5gLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyByZWZyZXNoVG9rZW4gfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YS5tZXNzYWdlIHx8ICdLaMO0bmcgdGjhu4MgbMOgbSBt4bubaSB0b2tlbicpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1c2VyRGF0YVN0ciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyRGF0YScpO1xuICAgICAgaWYgKHVzZXJEYXRhU3RyKSB7XG4gICAgICAgIGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZSh1c2VyRGF0YVN0cik7XG4gICAgICAgIGNvbnN0IHRva2VuRXhwaXJ5ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgKyA4ICogNjAgKiA2MDtcbiAgICAgICAgY29uc3QgdXBkYXRlZFVzZXJEYXRhID0geyAuLi51c2VyRGF0YSwgZXhwOiB0b2tlbkV4cGlyeSB9O1xuICAgICAgICBcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJEYXRhJywgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFVzZXJEYXRhKSk7XG4gICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGB1c2VyRGF0YT0ke2VuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh1cGRhdGVkVXNlckRhdGEpKX07IHBhdGg9LzsgbWF4LWFnZT0kezYwKjYwKjh9YDtcbiAgICAgICAgc2V0VXNlcih1cGRhdGVkVXNlckRhdGEpO1xuICAgICAgfVxuXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndG9rZW4nLCBkYXRhLnRva2VuKTtcbiAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGB0b2tlbj0ke2RhdGEudG9rZW59OyBwYXRoPS87IG1heC1hZ2U9JHs2MCo2MCo4fWA7XG4gICAgICBcbiAgICAgIHJldHVybiBkYXRhLnRva2VuO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdM4buXaSBsw6BtIG3hu5tpIHRva2VuOicsIGVycm9yKTtcbiAgICAgIGxvZ291dCgpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9O1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGlzQXV0aGVudGljYXRlZCkge1xuICAgICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIHJlZnJlc2hUb2tlbigpO1xuICAgICAgfSwgNyAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIFxuICAgICAgY29uc3Qgc2Vzc2lvbkludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBjaGVja0FuZExvZ291dElmRXhwaXJlZCgpO1xuICAgICAgfSwgNjAgKiAxMDAwKTtcbiAgICAgIFxuICAgICAgc2V0VG9rZW5SZWZyZXNoSW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgc2V0U2Vzc2lvbkNoZWNrSW50ZXJ2YWwoc2Vzc2lvbkludGVydmFsKTtcbiAgICAgIFxuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoc2Vzc2lvbkludGVydmFsKTtcbiAgICAgICAgc2V0VG9rZW5SZWZyZXNoSW50ZXJ2YWwobnVsbCk7XG4gICAgICAgIHNldFNlc3Npb25DaGVja0ludGVydmFsKG51bGwpO1xuICAgICAgfTtcbiAgICB9XG4gIH0sIFtpc0F1dGhlbnRpY2F0ZWQsIHJvdXRlcl0pO1xuXG4gIHJldHVybiAoXG4gICAgPEF1dGhDb250ZXh0LlByb3ZpZGVyXG4gICAgICB2YWx1ZT17e1xuICAgICAgICB1c2VyLFxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgICAgIGlzTG9hZGluZyxcbiAgICAgICAgbG9naW4sXG4gICAgICAgIGxvZ291dCxcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBjaGVja1Nlc3Npb25cbiAgICAgIH19XG4gICAgPlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvQXV0aENvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59O1xuXG5leHBvcnQgY29uc3QgdXNlQXV0aCA9ICgpID0+IHtcbiAgY29uc3QgY29udGV4dCA9IHVzZUNvbnRleHQoQXV0aENvbnRleHQpO1xuICBcbiAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcigndXNlQXV0aCBwaOG6o2kgxJHGsOG7o2Mgc+G7rSBk4bulbmcgdHJvbmcgcGjhuqFtIHZpIEF1dGhQcm92aWRlcicpO1xuICB9XG4gIFxuICByZXR1cm4gY29udGV4dDtcbn07ICJdLCJuYW1lcyI6WyJSZWFjdCIsImNyZWF0ZUNvbnRleHQiLCJ1c2VTdGF0ZSIsInVzZUVmZmVjdCIsInVzZUNvbnRleHQiLCJ1c2VSb3V0ZXIiLCJBdXRoQ29udGV4dCIsInVuZGVmaW5lZCIsIkF1dGhQcm92aWRlciIsImNoaWxkcmVuIiwidXNlciIsInNldFVzZXIiLCJpc0F1dGhlbnRpY2F0ZWQiLCJzZXRJc0F1dGhlbnRpY2F0ZWQiLCJpc0xvYWRpbmciLCJzZXRJc0xvYWRpbmciLCJ0b2tlblJlZnJlc2hJbnRlcnZhbCIsInNldFRva2VuUmVmcmVzaEludGVydmFsIiwic2Vzc2lvbkNoZWNrSW50ZXJ2YWwiLCJzZXRTZXNzaW9uQ2hlY2tJbnRlcnZhbCIsInJvdXRlciIsImNoZWNrU2Vzc2lvbiIsInVzZXJEYXRhIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInVzZXJPYmoiLCJKU09OIiwicGFyc2UiLCJleHAiLCJjdXJyZW50VGltZSIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJub3ciLCJlcnJvciIsImNvbnNvbGUiLCJjaGVja0FuZExvZ291dElmRXhwaXJlZCIsImxvZyIsImxvZ291dCIsImNoZWNrQXV0aCIsInRva2VuIiwicHVzaCIsInJlbW92ZUl0ZW0iLCJkb2N1bWVudCIsImNvb2tpZSIsInVzZXJEYXRhU3RyIiwicm9sZSIsImxvZ2luIiwiZW1haWwiLCJwYXNzd29yZCIsIkFQSV9VUkwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQVBJX1VSTCIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsInN0cmluZ2lmeSIsImNhY2hlIiwib2siLCJzdGF0dXMiLCJ0ZXh0IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JEYXRhIiwibWVzc2FnZSIsImUiLCJFcnJvciIsImRhdGEiLCJqc29uIiwidG9rZW5FeHBpcnkiLCJzZXRJdGVtIiwicmVmcmVzaFRva2VuIiwiX2lkIiwiZnVsbF9uYW1lIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiY2xlYXJJbnRlcnZhbCIsInVwZGF0ZWRVc2VyRGF0YSIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJzZXNzaW9uSW50ZXJ2YWwiLCJQcm92aWRlciIsInZhbHVlIiwidXNlQXV0aCIsImNvbnRleHQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/contexts/AuthContext.tsx\n"));

/***/ })

});